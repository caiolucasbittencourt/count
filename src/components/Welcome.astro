import './styles.styl';

<div class="container">
  <main class="main-content">
    
    <section id="setup-section" class="fade-in">
      <div class="header">
        <h1>Count</h1>
        <p>A website that just... counts. For you.</p>
      </div>
      
      <div class="form-group">
        <label for="limit-select">I want you to count to:</label>
        <select id="limit-select" name="limit">
          <option value="100">100</option>
          <option value="500">500</option>
          <option value="1000" selected>1,000</option>
          <option value="5000">5,000</option>
          <option value="10000">10,000</option>
          <option value="50000">50,000</option>
        </select>
      </div>
      
      <button id="start-btn" class="cta-button">Start Counting</button>
    </section>

    <section id="counter-section" class="hidden">
      <h2 id="counter-display" class="counter-text">0</h2>
      <p id="done-message" class="hidden fade-in">There. I counted. Happy now?</p>
      <button id="reset-btn" class="cta-button hidden fade-in">Count Again</button>
    </section>

  </main>
</div>



<script is:inline>
  const setupSection = document.getElementById('setup-section');
  const counterSection = document.getElementById('counter-section');
  const limitSelect = document.getElementById('limit-select');
  const startBtn = document.getElementById('start-btn');
  const counterDisplay = document.getElementById('counter-display');
  const doneMessage = document.getElementById('done-message');
  const resetBtn = document.getElementById('reset-btn');

  let countInterval;
  let currentCount = 0;


  function startCounter() {
    const target = parseInt(limitSelect.value, 10);
    currentCount = 0;
    counterDisplay.textContent = '0';

    setupSection.classList.add('hidden');
    counterSection.classList.remove('hidden');
    doneMessage.classList.add('hidden');
    resetBtn.classList.add('hidden');
    
    const duration = Math.min(5000, target * 10);
    const intervalTime = Math.max(1, duration / target);
    
    countInterval = setInterval(() => {
      currentCount++;
      counterDisplay.textContent = currentCount.toLocaleString('en-US');

      if (currentCount >= target) {
        clearInterval(countInterval);
        doneMessage.classList.remove('hidden');
        resetBtn.classList.remove('hidden');
      }
    }, intervalTime);
  }

  function resetCounter() {
    clearInterval(countInterval);
    counterSection.classList.add('hidden');
    setupSection.classList.remove('hidden');
  }

  startBtn.addEventListener('click', startCounter);
  resetBtn.addEventListener('click', resetCounter);
</script>